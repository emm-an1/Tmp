import numpy as np
from scipy.interpolate import UnivariateSpline

def smooth_spline(df, x_col='x', y_col='y'):
    x = df[x_col].values
    y = df[y_col].values
    
    sort_idx = np.argsort(x)
    x_sorted = x[sort_idx]
    y_sorted = y[sort_idx]
    
    spline = UnivariateSpline(x_sorted, y_sorted, k=3)  # s=None is default
    y_smooth = spline(x_sorted)
    
    result = np.empty_like(y_smooth)
    result[sort_idx] = y_smooth
    return result
