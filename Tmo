import pandas as pd

def detect_header_footer(file_path):
    """
    Detects the header row and the number of footer rows in an Excel file.

    Args:
    file_path (str): The path to the Excel file.

    Returns:
    tuple: (header_row, footer_rows)
    """
    df = pd.read_excel(file_path, header=None)
    
    header_row = next((i for i, row in df.iterrows() if row.notna().sum() > 0), 0)
    
    footer_rows = next((i for i, row in enumerate(df[::-1].iterrows()) if row[1].notna().sum() > 0), 0)
    
    return header_row, footer_rows

def clean_excel_file(file_path):
    """
    Cleans an Excel file by removing initial text rows and footnote rows.

    Args:
    file_path (str): The path to the Excel file.

    Returns:
    pd.DataFrame: The cleaned DataFrame.
    """
    header_row, footer_rows = detect_header_footer(file_path)
    
    df = pd.read_excel(file_path, header=header_row)
    
    if footer_rows > 0:
        df = df[:-footer_rows]
    
    return df

# Example usage
# file_path = 'path_to_your_file.xlsx'
# cleaned_df = clean_excel_file(file_path)
# print(cleaned_df)
