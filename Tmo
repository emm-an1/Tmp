    pca = PCA(n_components=N_COMPONENTS)
    scores = pca.fit_transform(scaled)
    
    # Sign alignment: ensure largest absolute loading per PC is positive
    for j in range(N_COMPONENTS):
        if pca.components_[j, np.argmax(np.abs(pca.components_[j]))] < 0:
            pca.components_[j] *= -1
            scores[:, j] *= -1
    
    expl_var[i] = pca.explained_variance_ratio_
    loadings[i] = pca.components_.T
    pc_scores_latest[i] = scores[-1]
